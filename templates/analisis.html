<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Análisis Avanzado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-4">

    <h2 class="text-center mb-4">Análisis Avanzado</h2>

    <div class="text-center mb-3">
        <a href="/dashboard" class="btn btn-secondary">Volver al Dashboard</a>
    </div>

    <!-- ============================= -->
    <!-- FILTROS                       -->
    <!-- ============================= -->
    <div class="card shadow mb-4">
        <div class="card-header bg-primary text-white">
            Filtros
        </div>
        <div class="card-body">

            <form method="get">

                <div class="row mb-3">
                    <div class="col">
                        <label class="form-label">EAN</label>
                        <select class="form-select" name="ean">
                            <option value="">Todos</option>
                            {% for x in filtros_analisis.ean %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col">
                        <label class="form-label">Producto</label>
                        <select class="form-select" name="descripcion">
                            <option value="">Todos</option>
                            {% for x in filtros_analisis.descripcion %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col">
                        <label class="form-label">Proveedor</label>
                        <select class="form-select" name="proveedor">
                            <option value="">Todos</option>
                            {% for x in filtros_analisis.proveedor %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col">
                        <label class="form-label">Mes</label>
                        <select class="form-select" name="mes">
                            <option value="">Todos</option>
                            {% for x in filtros_analisis.mes %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>

                <div class="row mb-3">

                    <div class="col">
                        <label class="form-label">Tienda</label>
                        <select class="form-select" name="tienda">
                            <option value="">Todas</option>
                            {% for x in filtros_analisis.tienda %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col">
                        <label class="form-label">Calidad</label>
                        <select class="form-select" name="calidad">
                            <option value="">Todas</option>
                            {% for x in filtros_analisis.calidad %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="col">
                        <label class="form-label">Sub Tipo Caso</label>
                        <select class="form-select" name="subtipo">
                            <option value="">Todos</option>
                            {% for x in filtros_analisis.subtipo %}
                                <option value="{{ x }}">{{ x }}</option>
                            {% endfor %}
                        </select>
                    </div>

                </div>

                <div class="text-center">
                    <button class="btn btn-primary">Aplicar filtros</button>
                    <a href="/analisis" class="btn btn-danger">Resetear</a>
                </div>

            </form>
        </div>
    </div>

    <!-- ========================================= -->
    <!-- TARJETAS DEL ANÁLISIS AVANZADO           -->
    <!-- ========================================= -->

    <div class="card mb-4 shadow">
        <div class="card-header bg-primary text-white">Top 10 Productos más reclamados</div>
        <div class="card-body">
            {% for prod, cant in top_prod.items() %}
                <p><strong>{{ prod }}</strong>: {{ cant }}</p>
            {% endfor %}
        </div>
    </div>

    <div class="card mb-4 shadow">
        <div class="card-header bg-primary text-white">Top 10 Proveedores con más reclamos</div>
        <div class="card-body">
            {% for prov, cant in top_prov.items() %}
                <p><strong>{{ prov }}</strong>: {{ cant }}</p>
            {% endfor %}
        </div>
    </div>

    <div class="card mb-4 shadow">
        <div class="card-header bg-primary text-white">Reclamos por Mes</div>
        <div class="card-body">
            {% for mes, cant in reclamos_mes.items() %}
                <p><strong>{{ mes }}</strong>: {{ cant }}</p>
            {% endfor %}
        </div>
    </div>

    <div class="card mb-4 shadow">
        <div class="card-header bg-primary text-white">Sub Tipos de Caso más frecuentes</div>
        <div class="card-body">
            {% for st, cant in subtipos.items() %}
                <p><strong>{{ st }}</strong>: {{ cant }}</p>
            {% endfor %}
        </div>
    </div>

</div>

</body>
</html>
